<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wordle Game</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1 id="title">Wordle Game</h1>

    <!-- Language Selection -->
    <div>
        <label for="language">Select Language:</label>
        <select id="language">
            <option value="en">English</option>
            <option value="hi">Hindi</option>
            <option value="kn">Kannada</option>
            <option value="ta">Tamil</option>
            <option value="ml">Malayalam</option>
        </select>
        <button id="apply_language">Apply</button>
    </div>

    <!-- Category Selection -->
    <div>
        <label id="category_label" for="category">Select Your Category:</label>
        <select id="category">
            <option value="" disabled selected>Select your category</option>
            <option value="animal">Animal</option>
            <option value="bird">Bird</option>
            <option value="flower">Flower</option>
            <option value="vehicle">Vehicle</option>
            <option value="fruit">Fruit</option>
            <option value="vegetable">Vegetable</option>
            <option value="colors">Colors</option>
            <option value="clothes">Clothes</option>
            <option value="weather">Weather</option>
            <option value="jobs">Jobs</option>
            <option value="sports">Sports</option>
            <option value="body parts">Body Parts</option>
            <option value="insects">Insects</option>
        </select>
    </div>

    <!-- Guess Selection -->
    <div>
        <label id="guess_label" for="guess">Select Your Guess:</label>
        <select id="guess" disabled>
            <option value="" disabled selected>Select a category first</option>
        </select>
    </div>

    <!-- Buttons -->
    <button id="submit_guess" disabled>Submit Guess</button>
    <button id="hint_button">Hint</button>
    <button id="reset_button">Reset Game</button>
    <button id="show_button">Show Word</button>

    <!-- Feedback Section -->
    <div id="feedback"></div>

    <script>
        $(document).ready(function () {
            // Handle language translation
            $("#apply_language").click(function () {
                const language = $("#language").val();
                $.ajax({
                    url: "/translate",
                    method: "POST",
                    contentType: "application/json",
                    data: JSON.stringify({ language }),
                    success: function (response) {
                        $("#title").text(response.title);
                        $("#category_label").text(response.category_label);
                        $("#guess_label").text(response.guess_label);
                        $("#submit_guess").text(response.submit_guess);
                        $("#hint_button").text(response.hint_button);
                        $("#reset_button").text(response.reset_button);
                        $("#show_button").text(response.show_button);
                    },
                    error: function () {
                        alert("Failed to load translations. Please try again.");
                    }
                });
            });

            // Populate subcategories when a category is selected
            $("#category").change(function () {
                const category = $(this).val();
                if (category) {
                    $.ajax({
                        url: "/subcategories",
                        method: "GET",
                        data: { category },
                        success: function (response) {
                            const subcategories = response.subcategories;
                            const guessDropdown = $("#guess");
                            guessDropdown.prop("disabled", false).empty();
                            guessDropdown.append(`<option value="" disabled selected>Select your guess</option>`);
                            subcategories.forEach(sub => {
                                guessDropdown.append(`<option value="${sub}">${sub}</option>`);
                            });
                            $("#submit_guess").prop("disabled", false);
                        },
                        error: function () {
                            alert("Failed to load subcategories. Please try again.");
                        }
                    });
                }
            });

            // Handle guess submission
            $("#submit_guess").click(function () {
                const language = $("#language").val();
                const guess = $("#guess").val();
                const category = $("#category").val();
                $.ajax({
                    url: "/guess",
                    method: "POST",
                    contentType: "application/json",
                    data: JSON.stringify({ guess, category, language }),
                    success: function (response) {
                        let feedback = `<p>${response.message}</p>`;
                        feedback += `<p>Similarity Score: ${response.similarity.toFixed(2)}</p>`;
                        $("#feedback").html(feedback);
                    }
                });
            });

            // Handle hint requests
            $("#hint_button").click(function () {
                const language = $("#language").val();
                $.ajax({
                    url: "/hint",
                    method: "GET",
                    data: { language },
                    success: function (response) {
                        $("#feedback").append(`<p>${response.hint}</p>`);
                    }
                });
            });

            // Reset the game
            $("#reset_button").click(function () {
                $.ajax({
                    url: "/reset",
                    method: "POST",
                    success: function (response) {
                        $("#feedback").html(`<p>${response.message}</p>`);
                        $("#guess").prop("disabled", true).empty();
                        $("#submit_guess").prop("disabled", true);
                    }
                });
            });

            // Show the target word
            $("#show_button").click(function () {
                $.ajax({
                    url: "/show",
                    method: "GET",
                    success: function (response) {
                        $("#feedback").append(`<p>The word was: ${response.word}</p>`);
                    }
                });
            });
        });
    </script>
</body>
</html>
